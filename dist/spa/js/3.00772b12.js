(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"420b":function(e,t,o){"use strict";o("ec17")},"8d93":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-page",[o("create-post-panel")],1)},i=[],n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"camera-frame rounded-borders shadow-4 q-pa-sm"},[o("transition",{attrs:{name:"capture",mode:"out-in",absolute:""}},[o("video",{directives:[{name:"show",rawName:"v-show",value:!e.isImageCaptured,expression:"!isImageCaptured"}],ref:"video",attrs:{autoplay:"",crossorigin:""}})]),o("transition",{attrs:{name:"capture",mode:"out-in",absolute:""}},[o("canvas",{directives:[{name:"show",rawName:"v-show",value:e.isImageCaptured,expression:"isImageCaptured"}],ref:"canvas"})])],1),o("div",{staticClass:"camera-input-row row justify-center text-center q-my-md"},[o("div",{staticClass:"col-12 col-sm-6"},[e.hasCameraSupport?o("q-btn",{class:{ready:e.isPostReadyToSend},attrs:{icon:e.isImageCaptured?"eva-trash":"eva-camera",size:e.$q.screen.xs?"18px":"24px",color:"primary",round:""},on:{click:e.captureDeleteCameraStramFrame}}):o("q-btn",{class:{ready:e.isPostReadyToSend},attrs:{icon:e.isImageCaptured?"eva-trash":"eva-upload-outline",size:e.$q.screen.xs?"18px":"24px",color:"primary",round:""},on:{click:e.showFilePicker}}),o("q-file",{ref:"fileInput",staticStyle:{display:"none"},attrs:{accept:"image/*"},on:{input:e.captureDeleteLocalImageFile},model:{value:e.localStorageImage,callback:function(t){e.localStorageImage=t},expression:"localStorageImage"}}),o("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.isPostReadyToSend,expression:"isPostReadyToSend"}],class:{ready:e.isPostReadyToSend},attrs:{color:"primary",icon:"eva-cloud-upload-outline",size:e.$q.screen.xs?"18px":"24px",round:""},on:{click:e.createPost}})],1)]),o("div",{staticClass:"row justify-center"},[o("div",{staticClass:"col-12 col-sm-6"},[o("q-input",{directives:[{name:"show",rawName:"v-show",value:e.hasGeolocationSupport,expression:"hasGeolocationSupport"}],staticClass:"col-12 q-my-sm",attrs:{label:"Location",type:"text",disable:!e.isGeolocationAllowed,error:e.onGeolocationErrors,"error-message":e.geolocationErrorMessage,"no-error-icon":"",dense:""},on:{blur:function(t){e.onGeolocationErrors=!1}},scopedSlots:e._u([{key:"append",fn:function(){return[o("q-btn",{attrs:{loading:e.isLoadingGeolocation,color:"primary",icon:"eva-navigation-2-outline",flat:"",round:""},on:{click:e.checkDeviceGelocation}})]},proxy:!0}]),model:{value:e.post.location,callback:function(t){e.$set(e.post,"location",t)},expression:"post.location"}}),o("q-input",{staticClass:"col-12 q-my-sm",attrs:{label:"Caption",type:"text",dense:""},model:{value:e.post.caption,callback:function(t){e.$set(e.post,"caption",t)},expression:"post.caption"}})],1)])])},s=[],r=(o("99af"),o("4160"),o("e260"),o("c19f"),o("ace4"),o("d3b7"),o("e6cf"),o("a79d"),o("ac1f"),o("1276"),o("5cc6"),o("9a8c"),o("a975"),o("735e"),o("c1ac"),o("d139"),o("3a7b"),o("d5d6"),o("82f8"),o("e91f"),o("60bd"),o("5f96"),o("3280"),o("3fcc"),o("ca91"),o("25a1"),o("cd26"),o("3c5d"),o("2954"),o("649e"),o("219c"),o("170b"),o("b39a"),o("72f7"),o("159b"),o("1732"));o("121f");var c={name:"AppCreatePostPanel",beforeMount:function(){this.initCamera()},beforeDestroy:function(){this.disableCamera()},data:function(){return{hasCameraSupport:!0,isGeolocationAllowed:!0,isImageCaptured:!1,localStorageImage:[],isLoadingGeolocation:!1,onGeolocationErrors:!1,geolocationErrorMessage:"Error on get location",post:{id:Object(r["a"])(),location:"",caption:"",photo:null,created_at:Date.now()}}},computed:{hasGeolocationSupport:function(){return!!navigator.geolocation},isPostReadyToSend:function(){return!!(this.post.photo&&this.post.location&&this.post.caption)}},methods:{initCamera:function(){var e=this;navigator.mediaDevices.getUserMedia({video:!0}).then((function(t){e.$refs.video.srcObject=t})).catch((function(t){e.hasCameraSupport=!1}))},disableCamera:function(){this.$refs.video.srcObject.getVideoTracks().forEach((function(e){e.stop()}))},showFilePicker:function(){this.isImageCaptured?(this.localStorageImage=null,this.post.photo=null,this.isImageCaptured=!1):this.$refs.fileInput.$el.click()},captureDeleteCameraStramFrame:function(){if(this.post.photo=null,this.isImageCaptured)this.initCamera();else{var e=this.$refs.video,t=this.$refs.canvas,o=t.getContext("2d");t.width=e.getBoundingClientRect().width,t.height=e.getBoundingClientRect().height,o.drawImage(e,0,0,t.width,t.height),this.post.photo=this.dataURItoBlob(t.toDataURL()),this.disableCamera()}this.isImageCaptured=!this.isImageCaptured},captureDeleteLocalImageFile:function(e){var t=this;if(console.log("file",e),!this.isImageCaptured&&e){var o=this.$refs.canvas,a=o.getContext("2d");this.post.photo=e;var i=new FileReader;i.onload=function(e){var i=new Image;i.onload=function(){o.width=i.width,o.height=i.height,a.drawImage(i,0,0),t.isImageCaptured=!0},i.src=e.target.result},i.readAsDataURL(e)}},dataURItoBlob:function(e){for(var t=atob(e.split(",")[1]),o=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(t.length),i=new Uint8Array(a),n=0;n<t.length;n++)i[n]=t.charCodeAt(n);var s=new Blob([a],{type:o});return s},checkDeviceGelocation:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(this.onAccessAllowed,this.onAccessDenied):console.log("Geolocation not supported")},onAccessAllowed:function(e){var t=this;this.isLoadingGeolocation=!0;var o="https://geocode.xyz/".concat(e.coords.latitude,",").concat(e.coords.longitude,"?json=1");this.$axios.get(o).then((function(e){t.post.location=e.data.city+","+e.data.region})).catch((function(e){t.onGeolocationErrors=!0})).finally((function(){t.isLoadingGeolocation=!1}))},onAccessDenied:function(e){this.isGeolocationAllowed=!1,this.onGeolocationErrors=!0,this.geolocationErrorMessage="Geolocation not allowed"},createPost:function(){}}},l=c,d=(o("420b"),o("2877")),u=o("9c40"),p=o("7d53"),h=o("27f9"),m=o("eebe"),g=o.n(m),f=Object(d["a"])(l,n,s,!1,null,null,null),v=f.exports;g()(f,"components",{QBtn:u["a"],QFile:p["a"],QInput:h["a"]});var w={name:"CreatePage",components:{CreatePostPanel:v}},C=w,b=o("9989"),y=Object(d["a"])(C,a,i,!1,null,null,null);t["default"]=y.exports;g()(y,"components",{QPage:b["a"]})},ec17:function(e,t,o){}}]);